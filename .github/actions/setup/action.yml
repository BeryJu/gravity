name: "Setup"
description: Setup all Gravity test dependencies

runs:
  using: "composite"
  steps:
    - uses: actions/setup-go@44694675825211faa026b3c33043df3e48a5fa00 # v6
      with:
        go-version-file: go.mod
        cache: true
    - uses: actions/setup-node@a0853c24544627f65ddf259abe73b1d18a591444 # v5
      with:
        node-version-file: web/package.json
        cache: "npm"
        cache-dependency-path: web/package-lock.json
    - shell: bash
      run: make web-install gen-client-ts web-build
    - shell: bash
      run: make test-env-start
    - shell: bash
      run: make install-deps gen-clean gen-client-go gen-external-dns gen-go-tidy
